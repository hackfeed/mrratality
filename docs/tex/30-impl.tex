\chapter{Технологическая часть}

В данном разделе представлены средства разработки программного обеспечения, детали реализации и тестирование функций.

\section{Средства реализации}

В качестве языка программирования, на котором будет реализовано программное обеспечение, выбран язык TypeScript 4 \cite{ts}. Выбор языка обусловлен тем, что динамический контент на веб-страницах разрабатывается и управляется на языке JavaScript \cite{js}. TypeScript является типизированной версией JavaScript и позволяет избежать ошибок, связанных с неправильным использованием типов при разработке. На выходе TypeScript транспилируется в JavaScript.

Разработанный скрипт будет подключаться к уже существующей веб-странице. Поэтому стоит задача минимизации размера скрипта для уменьшения времени загрузки страницы.

Для минимизации размера выходного файла будет использоваться упаковщик webpack \cite{webpack}. Вместе с ts-loader \cite{tsloader} он позволяет автоматически транспилировать файлы TypeScript в JavaScript и минимизировать их размер путем сокращения названий переменных, функций, удаления пробелов в исходном коде.

Для тестирования программного обеспечения будет использоваться фреймворк \cite{framework} Jest \cite{jest}. Данный инструмент предоставляет широкие возможности для тестрования приложений, такие как разработка заглушек, имитация запросов и т.п.

Для обеспечения качества кода был использован инструмент ESLint \cite{eslint}, позволяющий во время написания кода контроллировать наличие синтаксических и логических ошибок.

В качестве среды разработки выбран текстовый редактор Visual Studio Code \cite{vscode}. Данный выбор обусловлен большим количеством плагинов под разные инструменты. Плагины позволяют облешчить и ускорить разработку программного обеспечения.

Для определения доминантного цвета на странице были использованы в связке библиотеки html2canvas \cite{html2canvas} и Color Thief \cite{colorthief}. html2canvas позволяет пробразовать страницу к изображению, а Color Thief выделяет карту цветов и доминантный цвет.

\section{Детали реализации}

В листингах \ref{lst:luminance} -- \ref{lst:change} приведены реализации алгоритмов нахождения относительной яркости, нахождение доминантного цвета и изменения цветов на основе доминантного соответственно. 

Для изменения цветового представления у элементов DOM-дерева изменялись атрибуты, отвечающие за цветовые характеристики, такие как background-color, color, border-color и т.п. Все эти атрибуты имеют в своем названии ключевое слово color, поэтому для нахождения всех таких атрибутов достаточно было применить фильтр по ключевому слову color. Реализация такого фильтра с последующим изменением представлена в листинге \ref{lst:change}.

\begin{lstinputlisting}[
	caption={Реализация алгоритма нахождения относительной яркости},
	label={lst:luminance},
	style={ES6},
	linerange={80-91},
	]{/home/hackfeed/bmstu/labs/darkify/src/extension/darkify.ts}
\end{lstinputlisting}

\begin{lstinputlisting}[
	caption={Реализация алгоритма нахождения доминантного цвета},
	label={lst:domcolor},
	style={ES6},
	linerange={100-127},
	]{/home/hackfeed/bmstu/labs/darkify/src/extension/darkify.ts}
\end{lstinputlisting}

\begin{lstinputlisting}[
	caption={Реализация алгоритма подбора цветов на основе базовго},
	label={lst:change},
	style={ES6},
	linerange={128-173},
	]{/home/hackfeed/bmstu/labs/darkify/src/extension/darkify.ts}
\end{lstinputlisting}

\section*{Вывод}

В данном разделе были представлены средства реализации программного обеспечения и листинги программного обеспечения, разработанного на основе схем конструкторского раздела.
